---
title: "[Computer Graphics] #11. 오일러 변환 및 쿼터니언"
excerpt: "한정현 컴퓨터 그래픽스 강의 11장 정리"

categories:
  - Computer Graphics
tags:
  - [Computer Graphics, graphics, cg, euler transforms, euler, quaternions]

permalink: /computer-graphics/euler-transforms-and-quaternions/

toc: true
toc_sticky: true

date: 2023-04-10 20:55:57+0900
last_modified_at: 2023-04-10 20:56:00+0900
published: false
---

## 👻 오일러 변환 및 쿼터니언
오일러 변환
세 개의 주축 중심 회전을 결합한 것. 월드 공간을 택할 수도 있고 오브젝트 공간을 택할 수도 있다.
세 축 중심의 회전각을 오일러 각이라 부름
순서를 바꾸면 결과값도 달라짐

오브젝트 공간 오일러 변환
같은 각이더라도 월드 공간 오일러 각 적용과 결과가 다르다
두 번째 결과값은 월드공간 주축 계산 반대로 하면 구할 수 있다.
z축을 포함하여 세 번의 회전이 있다면 역시나 월드 오일러 회전의 반대 순서로 결과값을 구할 수 있다.
물체에 임의의 방향을 제공하는 보다 직접적인 방법은 임의의 축을 중심으로 회전 시키는 것

키프레임 애니메이션과 오일러 변환
60fps 애니메이션의 경우 1초에 60보다 훨씬 적은 수의 프레임에 대해서만 동작을 정의한다. 이를 키프레임이라 부른다.
중간에 있는 프레임은 in-between frames
키프레임 사이의 중간 프레임은 런타임에 자동으로 채워진다.
-2차원 키프레임 애니메이션
키프레임에 할당된 중요 데이터를 키 데이터
중간 프레임에서는 키 데이터가 보간됨
선형보간 이용
초기 각도를 0도 세타 제로, 후를 세타원. 각도도 똑같이 선형보간
-3차원 키프레임 애니메이션
2차원 키프레임 보간이 그대로 적용
중간 프레임에서의 오일러 각과 xyz를 얻기 위해서는 키 프레임별 그래프를 동일한 시간에서 샘플링
-> 각 축마다 변경된 정보를 동일한 시간에서 샘플링
선형 보간이 싫다면 더욱 부드러운 애니메이션 표현을 위해 고차원 보간도 가능. (ppt)
핵심
1. 물체의 회전이 물체의 방향을 결정한다.
2. 그 회전은 오일러 변환이 담당할 수 있다.
3. 오일러 회전은 각도 세개로 표현이 된다
4. 그 각도들은 키데이터를 형성하고 중간 프레임에서는 보간이 된다.
5. 보간된 각도는 행렬 세개를 만들수 있고, 세개는 하나로 되고 그건 중간 프레임 결과가 나온다.

오일러 각의 보간
오일러 각이 가진 문제 중, 올바르게 보간ㄱ된다는 보장이 없다는 사실(L자 물체는 x좌표를 비교해보면 yz평면에 위치하지 않는 것을 알 수 있따.)
오일러 각은 올바르게 보간된다는 보장이 없기 때문에 보간을 핵심 기능으로 가지는 키프레임 애니메이션에 적합하지 않다
->다른 기법 : 쿼터니언
쿼터니언은 항상 올바르게 보간

쿼터니언
쿼터니언 q는 복소수를 확장한 것. 네 개의 항으로 표현됨 우리말로 4원수라고도함
두 개의 서로 다른 허수단위 곱 : 순환치환적인 특징을 가짐, 교환법칙은 성립하지 않음
쿼터니언도 켤레를 가짐->허수부만 음수를 가지는 것 Conjugate 스타로 표현
쿼터니언의 크기는 벡터와 같은 계산
크기가 1이면 단위 쿼터니언
회전을 표현하느,ㄴ 쿼터니언의 크기는 1이어야함
쿼터니언의 보간은 구체 선형보간 -> 줄여서 slerp: spherical linear interpolation
해밀턴이 만듦
이렇게 나온 쿼터니언을 행렬로 표현? 가능
회전 행렬로 정의 가능. 역으로 회전 행렬이 주어졌을 때 쿼터니언을 계산하는 것 역시 가능
ㄴ> 슬럽으로 보간하면 새로운 쿼터니언이 나오는데 이 쿼터니언을 다른 변환 행렬을 적용하고 싶으면 행렬로 표현하여 사용하라~


12장. 스크린 물체 조작
렌더링된 물체 선택->피킹
피킹 시에 얻을 수 있는 정보는 스크린 상에서 손가락 혹은 마우스로 선택한 점의 2차원 좌표
이 좌표를 사용해서 해당 위치의 물체를 찾아내는 기법
-스크린 공간 광선
광선을 정의하여 이 광선에 의해 처음 부딪히는 물체가 선택될 것.
광선-0물체 교차 검사를 수행
스크린 공간에서는 수행 x -> 물체에 관한 정보가 없기 때문ㅇ
이 광선을 오브젝트 공간까지 변환하여 검사 수행
스크린 -> 카메라->오브젝트
역순으로 행렬 연산
1. 투영 행렬 연산
2. 방향 벡터 계산
카메라 공간 광선을 뒤로 늘이면 원점이 닿음
원점과 광선의 시작점을 연결한 벡터가 방향 벡터
->스크린 공간 광선의 방향 벡터

오브젝트 공간 광선
카메라 공간 광선->월드 공간->오브젝트 공간
월드 공간으로의 변환은 뷰 변환의 역변환
M-1은 T-1R-1ㅇ;ㅣ 된다

광선과 바운딩 볼륨 간 교차 검사
광선-삼각형 교차 검사 실시
각 메시를 완벽히 감싸는 바운딩 볼륨을 구한 뒤 이를 광선과의 교차 검사에 사용
직육면체 AABB
구는 바운딩 구
바운딩 구를 얻는 가장 단순한 방법은 AABB를 구하는 것
3차원으로 확장 가능
판별식으로 부딪혔는지 확인
광선과 처음으로 교차하는 물체로 선택
종종 붖정확함
정확한 계산은 반드시 폴리곤 메시의 모든 삼각형과 광선 간 교차 검사를 수행

광선과 삼각형 간 교차검사
p는 세 정점의 가중치 합으로 정의
p의 무게중심 좌표라고 함
u, v, w
u+v+w = 1
크레이머 법칙으로 풀이 가능



클립 공간까지 변환시킨 다음 래스터라이저 단계 후 라이팅




***

## 👻 글을 마치며


***

_출처_   
_[한정현 컴퓨터 그래픽스 강의 (11장-오일러 변환 및 쿼터니언)](https://youtu.be/XgE7tOSc7AU)_   
_[도서 관련 예제 GitHub](https://github.com/medialab-ku/openGLESbook)_   
_[PPT 강의 자료 및 사진 출처](https://media.korea.ac.kr/books/)_

_관련 도서_   
_OpenGL ES를 이용한 3차원 컴퓨터 그래픽스 입문 - 한정현 지음_   